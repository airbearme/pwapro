name: ðŸŽ¨ Validate UI/UX & Special Effects

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]
  workflow_dispatch:

env:
  NODE_VERSION: '20.x'

jobs:
  validate-ui:
    name: âœ… Validate UI/UX Effects
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Validate Core UI Foundation
        run: |
          echo "ðŸŽ¨ Validating Core UI/UX Foundation..."
          npm run validate:ui || exit 1

      - name: Check CSS animations exist
        run: |
          echo "Checking for CSS animation keyframes..."
          if grep -q "@keyframes pulse-glow" app/globals.css; then
            echo "âœ… pulse-glow animation found"
          else
            echo "âŒ pulse-glow animation missing"
            exit 1
          fi
          
          if grep -q "@keyframes float" app/globals.css; then
            echo "âœ… float animation found"
          else
            echo "âŒ float animation missing"
            exit 1
          fi
          
          if grep -q "animate-pulse-glow" app/globals.css; then
            echo "âœ… animate-pulse-glow utility found"
          else
            echo "âŒ animate-pulse-glow utility missing"
            exit 1
          fi
          
          if grep -q "animate-float" app/globals.css; then
            echo "âœ… animate-float utility found"
          else
            echo "âŒ animate-float utility missing"
            exit 1
          fi

      - name: Check special effects classes
        run: |
          echo "Checking for special effect classes..."
          required_classes=(
            "hover-lift"
            "glass-morphism"
            "animate-pulse-glow"
            "animate-float"
            "airbear-holographic"
            "airbear-plasma"
          )
          
          for class in "${required_classes[@]}"; do
            if grep -q "$class" app/globals.css || grep -q "$class" tailwind.config.ts; then
              echo "âœ… $class found"
            else
              echo "âš ï¸  $class not found (may be in components)"
            fi
          done

      - name: Validate map component
        run: |
          echo "Checking map component..."
          if [ -f "components/map-view-beautiful.tsx" ]; then
            echo "âœ… Map component exists"
          else
            echo "âŒ Map component missing"
            exit 1
          fi
          
          if grep -q "leaflet" components/map-view-beautiful.tsx; then
            echo "âœ… Leaflet integration found"
          else
            echo "âš ï¸  Leaflet integration may be missing"
          fi

      - name: Check dark mode configuration
        run: |
          echo "Checking dark mode configuration..."
          if grep -q 'defaultTheme="dark"' app/layout.tsx; then
            echo "âœ… Dark mode permanently enabled"
          else
            echo "âŒ Dark mode not configured"
            exit 1
          fi
          
          if grep -q 'enableSystem={false}' app/layout.tsx; then
            echo "âœ… System theme detection disabled"
          else
            echo "âš ï¸  System theme detection may be enabled"
          fi

      - name: Validate mascot presence
        run: |
          echo "Checking AirBear mascot..."
          if [ -f "public/airbear-mascot.png" ]; then
            echo "âœ… Mascot image exists"
          else
            echo "âš ï¸  Mascot image may be missing"
          fi
          
          # Check if mascot is used in key pages
          pages_with_mascot=0
          for file in app/page.tsx app/map/page.tsx app/auth/login/page.tsx app/auth/signup/page.tsx; do
            if [ -f "$file" ] && grep -q "airbear-mascot" "$file"; then
              pages_with_mascot=$((pages_with_mascot + 1))
            fi
          done
          echo "âœ… Mascot found in $pages_with_mascot key pages"

      - name: Summary
        run: |
          echo "## ðŸŽ¨ UI/UX Validation Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **CSS Animations**: Validated" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Special Effects**: Validated" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Map Component**: Validated" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Dark Mode**: Validated" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Mascot**: Validated" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "All UI/UX components are properly configured!" >> $GITHUB_STEP_SUMMARY

