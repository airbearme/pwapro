## 2024-08-16 - Pragmatic CSP Implementation for Legacy Codebases
**Vulnerability:** Lack of a Content-Security-Policy (CSP) across the application, leaving it more susceptible to Cross-Site Scripting (XSS) attacks.
**Learning:** Attempting to implement an ideal, strict CSP (i.e., one without `'unsafe-inline'`) on a codebase that already relies on inline scripts and styles is not a "small fix." It can break significant parts of the application. The pragmatic first step is to implement a weaker CSP that includes `'unsafe-inline'` but correctly configures other directives (`default-src`, `connect-src`, etc.). This provides immediate, partial protection and establishes a baseline policy.
**Prevention:** When adding a CSP to an existing application, always start by auditing for inline scripts and styles. If they are present, the initial security enhancement should be a slightly weaker, but non-breaking, CSP. This should be explicitly documented in the code as a known trade-off, with a recommendation to create a follow-up task to refactor the inline code, which would enable a stricter policy in the future. This iterative approach to security hardening is safer than a "perfect-or-nothing" approach.